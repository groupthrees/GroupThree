
@{
    Layout = null;
}

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <script src="~/Wine/酒仙网-确认订单页面/订单结算-酒仙网_files/mv.js" async="" type="text/javascript"></script>
    <script src="~/Wine/酒仙网-确认订单页面/订单结算-酒仙网_files/mba.js" async="" type="text/javascript"></script>
    <script src="~/Wine/酒仙网-确认订单页面/订单结算-酒仙网_files/pushData.txt" charset="utf-8" async="" type="text/javascript"></script>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="Expires" content="0" />
    <meta http-equiv="Cache-Control" content="no-cache" />
    <meta http-equiv="Pragma" content="no-cache" />
    <title>订单结算-酒仙网</title>
    <link href="~/Wine/酒仙网-确认订单页面/订单结算-酒仙网_files/base_002.css" rel="stylesheet" type="text/css" />
    <link href="~/Wine/酒仙网-确认订单页面/订单结算-酒仙网_files/header_cart_new.css" rel="stylesheet" type="text/css" />
    <link href="~/Wine/酒仙网-确认订单页面/订单结算-酒仙网_files/footer.css" rel="stylesheet" type="text/css" />
    <script src="~/Wine/酒仙网-确认订单页面/订单结算-酒仙网_files/visittrack.js" async="" type="text/javascript"></script>
    <script src="~/Wine/酒仙网-确认订单页面/订单结算-酒仙网_files/mvl.js" async="" type="text/javascript"></script>
    <script src="~/Wine/酒仙网-确认订单页面/订单结算-酒仙网_files/jquery.js" type="text/javascript"></script>
    <script src="~/Wine/酒仙网-确认订单页面/订单结算-酒仙网_files/jquery_002.js" type="text/javascript"></script>
    <script src="~/Wine/酒仙网-确认订单页面/订单结算-酒仙网_files/base.js" type="text/javascript"></script>

    <script src="~/Wine/酒仙网-确认订单页面/订单结算-酒仙网_files/public.js" type="text/javascript"></script>

    <script src="~/js/jquery-3.2.1.js"></script>
    <script src="~/js/layer.js"></script>

    <script src="~/Wine/酒仙网-确认订单页面/订单结算-酒仙网_files/jquery-1.js" type="text/javascript"></script>
    <script src="~/Wine/酒仙网-确认订单页面/订单结算-酒仙网_files/address.js" type="text/javascript"></script>
    <script src="~/Wine/酒仙网-确认订单页面/订单结算-酒仙网_files/slider_1.js" type="text/javascript"></script>
    <link rel="stylesheet" type="text/css" href="~/Wine/酒仙网-确认订单页面/订单结算-酒仙网_files/base.css" />
    <link rel="stylesheet" type="text/css" href="~/Wine/酒仙网-确认订单页面/订单结算-酒仙网_files/order.css" />
    <link href="~/layer-v2.4/layer/skin/layer.css" rel="stylesheet" />
    <link href="~/css/bootstrap.css" rel="stylesheet" />

</head>
<body>
    <iframe id="mediav_cookiemapping" src="~/Wine/酒仙网-确认订单页面/订单结算-酒仙网_files/b.html" style="width: 1px; border: 0px none; position: absolute; left: -100px; top: -100px; height: 1px;"></iframe>
    <!-- 全站公共url变量 -->
    @*//报存地址id*@
    <input id="Hidden1" type="hidden" />

    <div class="topHeaderWrap">
        <div class="topHeader">
            <div class="topCollect">
                <ul>
                    <li name="_login_status_panel"><span> hi，<span class="userName" title="jxw52743765">jxw52743765</span><span><a href="https://login.jiuxian.com/logout.htm" class="cartlogout">退出</a><a class="newsNum" href="http://member.jiuxian.com/jxcircle/info_center-0.htm" target="_blank"><em>消息</em><i class="mesNum">5</i></a><a class="newsNum" href="http://member.jiuxian.com/purse/my_gold_coin-1.htm" target="_blank"><em>金币</em><i class="mesNum">60</i></a></span></span><i></i></li>
                </ul>
            </div>
            <div class="topRight">
                <ul>
                    <li><a class="myOrder" target="_blank" href="/MyIndent/Index">我的订单</a><i></i></li>
                    <li><a class="userCenter" target="_blank" href="/UserMain/Index">我的酒仙网</a><i></i></li>
                    <li class="hotTel"><span>客服热线</span><strong>400-617-9999</strong></li>
                </ul>
            </div>
        </div>
    </div>
    <div class="midHeader">
        <div class="midHeaderBox">
            <div class="jxwLogo"><p style="background:url(http://img06.jiuxian.com/bill/2014/1226/a347f6723d3141fd9b9b9d464eff6fc7.png) no-repeat;" class="jxwIndex"><a href="http://www.jiuxian.com/"></a></p></div>
            <div class="bayProcess">
                <div class="proPic"></div>
                <div class="proTex"><span class="on">我的购物车</span><span class="on2">确认订单信息</span><span class="on3">成功提交订单</span></div>
            </div>
        </div>
    </div>



    <div class="orderWrap">
        <div class="orderBody">
            <!-- 标题 -->
            <!-- 收货地址信息 -->
            <div id="addressListDiv" class="pubWrap">
                <div class="pubTitle">
                    <h3>选择收货地址</h3>
                </div>
                <div id="list">

                </div>
                <div class="addressMoreBox">
                    <div style="display: none;" class="addressMore" flag="off"><a href="javascript:;"><span>展开收货地址</span><i class="orderIcon"></i></a></div>
                    <div class="addressAdd"><a href="javascript:;"><i class="orderIcon"></i><span onclick="Address()">新增收货地址</span></a></div>
                </div>

            </div>
            <!-- 支付方式信息 -->
            <div class="pubWrap">
                <div class="pubTitle">
                    <h3>选择支付方式</h3>
                </div>
                <div class="payMent">
                    <div class="item cur">
                        <span>在线支付</span><i class="orderIcon"></i><s class="orderIcon"></s>
                        <div class="payPrompt">支持支付宝、微信等多种支付平台。<em class="orderIcon"></em></div>
                    </div>

                </div>
            </div>
            <!-- 商品信息 -->
            <div class="pubWrap">
                <div class="pubTitle">
                    <h3>确认订单信息</h3>
                    <div class="confirmRemind"><i class="orderIcon"></i><span>若商品来自不同商家和仓库，将按照仓库最优进行配送</span></div>
                </div>
                <div class="orderTable">
                    <div class="tHead">
                        <div class="oTd item-1">商品信息</div>
                        <div class="oTd item-2">单价</div>
                        <div class="oTd item-3">数量</div>

                        <div class="oTd item-4">状态</div>
                        <div class="oTd item-5">小计</div>
                    </div>
                    <div id="shopInfos"><div class="tBody"><div class="shopTitle"><a href="http://shop.jiuxian.com/index-1470.htm" target="_blank"><i class="orderIcon shop"></i><span>洋河官方旗舰店</span></a></div><div class="tMain"><div class="oTr"><div class="mainProduct "><div class="oTd item-1"><div class="img"><a href="http://www.jiuxian.com/goods-51820.html" target="_blank"><img src="~/Wine/酒仙网-确认订单页面/订单结算-酒仙网_files/bce6bb4392e742c3b288614a9022c9892.jfif" height="60" width="60" /></a></div><div class="name"><a href="http://www.jiuxian.com/goods-51820.html" target="_blank" style="text-align: left;">【爆款特卖】52°洋河蓝色经典梦之蓝M3 500ml</a><div class="promptBox"><div class="unUsed"><i class="orderIcon"></i><span>此商品不能使用优惠券</span></div></div></div></div><div class="oTd item-2">￥449.00</div><div class="oTd item-3">x1</div><div class="oTd item-4">有货</div><div class="oTd item-5">￥449.00</div></div></div><div class="oTr"><div class="mainProduct "><div class="oTd item-1"><div class="img"><a href="http://www.jiuxian.com/goods-85722.html" target="_blank"><img src="~/Wine/酒仙网-确认订单页面/订单结算-酒仙网_files/c6fafeee526747a484c5a6d18d5a3c552.jfif" height="60" width="60" /></a></div><div class="name"><a href="http://www.jiuxian.com/goods-85722.html" target="_blank" style="text-align: left;">【赠品】星得斯海拔H600赤霞珠干红葡萄酒750ml</a><div class="promptBox"></div></div></div><div class="oTd item-2">￥0.00</div><div class="oTd item-3">x1</div><div class="oTd item-4">有货</div><div class="oTd item-5">￥0.00</div></div></div></div></div></div>
                </div>
            </div>
            <table>
                <tr>
                    <td></td>
                </tr>
            </table>
            <!-- 结算金额 -->
            <div id="info" style="background-color:darkgrey;width:400px;height:200px;position:relative;left:600px;">

            </div>
        
        </div>

    </div>
    

    <!--新增收货地址 end-->
    <!--删除地址列表comfirm-->
    <div class="pubPop pop-4">
        <div class="pubInside">
            <div class="pubInsideTitle">
                <span>删除</span>
                <i class="orderIcon pubClose"></i>
            </div>
            <div class="pubInsideBody">
                <div class="warningText"><i class="orderIcon"></i><span>确定要删除该地址吗？</span></div>
                <div class="addrBtn"><a href="javascript:;" class="sure">确定</a><a href="javascript:;" class="cancel">取消</a></div>
            </div>
        </div>
    </div>

    <div class="pubPop pop-12">
        <div class="pubInside">
            <div class="pubInsideTitle">
                <span>提交订单</span>
                <i class="orderIcon pubClose" type="orderError"></i>
            </div>
            <div class="pubInsideBody">
                <div id="activateFailure" class="warningText failureText"><i class="orderIcon"></i><span>提交失败</span></div>
                <div class="pubText"></div>
                <div class="addrBtn"><a href="javascript:;" class="sure">我知道了</a></div>
            </div>
        </div>
    </div>
    <!--提交订单失败提框-->
    <script src="~/Wine/酒仙网-确认订单页面/订单结算-酒仙网_files/order.js" type="text/javascript"></script>
    <!--页脚-->
    <div class="footer">
        <div class="footerTopBox">
            <div class="footerTop">
                <div class="footerContact">
                    <i class="publicIcon"></i><b>400-617-9999</b><span>客服热线</span><span>9:00-23:00</span><span>贴心服务</span>
                </div>
                <div class="footerTopRight">
                    <div class="ftRight-tit">优惠促销早知道</div>
                    <div class="ftRight-form">
                        <input id="subscribe_email" name="" type="text" /><span>请输入您的邮箱地址</span><i class="publicIcon" id="subscribe_but"></i>
                    </div>
                </div>
            </div>
            <div class="footerServices">
                <ul class="clearfix">
                    <li class="servicesItme01">
                        <h3>
                            <i class="publicIcon"></i><span>新手入门</span>
                        </h3>
                        <p>
                            <a href="#" target="_blank" rel="nofollow">购物保障</a>
                        </p>
                        <p>
                            <a href="#" target="_blank" rel="nofollow">服务协议</a>
                        </p>
                        <p>
                            <a href="#" target="_blank" rel="nofollow">发票说明</a>
                        </p>
                    </li>
                    <li class="servicesItme02">
                        <h3>
                            <i class="publicIcon"></i><span>常见问题</span>
                        </h3>
                        <p>
                            <a href="#" target="_blank" rel="nofollow">红包使用</a>
                        </p>
                        <p>
                            <a href="#" target="_blank" rel="nofollow">返现使用</a>
                        </p>
                        <p>
                            <a href="#" target="_blank" rel="nofollow">兑换码</a>
                        </p>
                    </li>
                    <li class="servicesItme03">
                        <h3>
                            <i class="publicIcon"></i><span>配送说明</span>
                        </h3>
                        <p>
                            <a href="#" target="_blank" rel="nofollow">配送时间</a>
                        </p>
                        <p>
                            <a href="#" target="_blank" rel="nofollow">配送费用</a>
                        </p>
                        <p>
                            <a href="#" target="_blank" rel="nofollow">配送范围</a>
                        </p>
                    </li>
                    <li class="servicesItme04">
                        <h3>
                            <i class="publicIcon"></i><span>支付方式</span>
                        </h3>
                        <p>
                            <a href="#" target="_blank" rel="nofollow">货到付款</a>
                        </p>
                        <p>
                            <a href="#" target="_blank" rel="nofollow">在线支付</a>
                        </p>
                        <p>
                            <a href="#" target="_blank" rel="nofollow">线下支付</a>
                        </p>
                    </li>
                    <li class="servicesItme05">
                        <h3>
                            <i class="publicIcon"></i><span>售后服务</span>
                        </h3>
                        <p>
                            <a href="#" target="_blank" rel="nofollow">品质保证</a>
                        </p>
                        <p>
                            <a href="#" target="_blank" rel="nofollow">退换货政策</a>
                        </p>
                        <p>
                            <a href="#" target="_blank" rel="nofollow">退换货流程</a>
                        </p>
                    </li>
                    <li class="servicesItme06">
                        <h3>
                            <i class="publicIcon"></i><span>特色服务</span>
                        </h3>
                        <p>
                            <a href="#" target="_blank">会员俱乐部</a>
                        </p>
                        <p>
                            <a href="#" target="_blank" rel="nofollow">企业客户</a>
                        </p>
                        <p>
                            <a target="_blank" href="#">酒仙社区</a>
                        </p>
                    </li>
                    <li class="jxMicroblogging">
                        <div class="item sinaMb">
                            <div class="sinaMbCom clearfix">
                                <a href="#" target="_blank" rel="nofollow"><i class="publicIcon"></i></a><a href="#" target="_blank" rel="nofollow">酒仙新浪微博</a>
                            </div>
                        </div>
                        <div class="item weixin">
                            <div class="weixinCon clearfix">
                                <i class="publicIcon"></i><a id="jxWeixin" falg="hide" href="javascript:;" target="_blank" rel="nofollow">酒仙微信</a>
                            </div>
                            <div class="weixinCode" id="weixinCode">
                                <img src="~/Wine/酒仙网-确认订单页面/订单结算-酒仙网_files/weixin-code.jfif" />
                            </div>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
        <div class="footerBotBox">
            <div class="footerBot clearfix">
                <div class="footerBotLeft">
                    <p class="footerInfo">
                        <a href="#" target="_blank" rel="nofollow">公司简介<i></i></a> <a href="#" target="_blank" rel="nofollow">管理团队<i></i></a>
                        <a href="#" target="_blank" rel="nofollow">媒体报道<i></i></a> <a href="#" target="_blank" rel="nofollow">联系我们<i></i></a>
                        <a href="#" target="_blank">网站地图<i></i></a> <a href="#" target="_blank">品牌大全<i></i></a>
                    </p>
                    <p class="copyright">

                        北京酒仙网络科技有限公司&nbsp;&nbsp;©&nbsp;&nbsp;酒仙
                        网&nbsp;&nbsp;&nbsp;2011&nbsp;&nbsp;jiuxian.com&nbsp;&nbsp;All&nbsp;&nbsp;&nbsp;Rights&nbsp;Reserved&nbsp;&nbsp;&nbsp;<a href="#" target="_blank" rel="nofollow">京ICP备17043395号</a>&nbsp;&nbsp;&nbsp;京公网安备1101050188221
                    </p>
                    <p class="footerAddr" style="color: #999; line-height: 22px; padding-top: 5px;">
                        <span>统一社会信用代码&nbsp;&nbsp;91110302306646672B&nbsp;&nbsp;&nbsp;食品流通许可证编号&nbsp;&nbsp;JY11131010328793&nbsp;&nbsp;&nbsp;</span>
                    </p>
                    <p class="footerAddr" style="color: #999; line-height: 22px; padding-bottom: 7px;">
                        <span>地址：北京市北京经济技术开发区经海五路58号院8幢4层</span>
                    </p>
                    <p class="copybot">
                        <script src="~/Wine/酒仙网-确认订单页面/订单结算-酒仙网_files/seallogo.dll" type="text/javascript"></script>
                        <script size="0" src="~/Wine/酒仙网-确认订单页面/订单结算-酒仙网_files/icon3.js" cid="kx_verify" async="" id="kx_script"></script><span id="kx_verify" style="float: left; padding-right: 6px; display: inline-block; position: relative; width: 128px; height: 47px;"><a id="kx_verify_link" href="https://ss.knet.cn/verifyseal.dll?sn=2011040600100007749&amp;a=1&amp;pa=0.6338837876898306" tabindex="-1" target="_blank" kx_type="图标式" rel="nofollow"><img src="~/Wine/酒仙网-确认订单页面/订单结算-酒仙网_files/cnnic.png" style="border:0; position: absolute; top: 0px; left: 0px;" w="128" h="47" oncontextmenu="return false;" alt="可信网站" height="47" width="128" /></a></span>

                        <a href="#" target="_blank" rel="nofollow"><img src="~/Wine/酒仙网-确认订单页面/订单结算-酒仙网_files/copyBot03.jfif" height="47" width="128" /></a>

                    </p>
                    <p class="footerPro" style="padding: 8px 0 6px;">购买前请确认达到法定饮酒年龄！酒仙网不销售任何含酒精产品给18岁以下人士！</p>
                </div>
                <div class="footerBotCode">
                    <div class="jxPho-code">
                        <p class="codePic">
                            <img alt="手机酒仙网" src="~/Wine/酒仙网-确认订单页面/订单结算-酒仙网_files/jxPho-code.jfif" height="80" width="80" />
                        </p>
                        <p class="codeText">手机酒仙网</p>
                    </div>
                    <div class="jkd-code">
                        <p class="codePic">
                            <img alt="微信公众号" src="~/Wine/酒仙网-确认订单页面/订单结算-酒仙网_files/jx-wxgzh.png" height="80" width="80" />
                        </p>
                        <p class="codeText">微信公众号</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <style type="text/css">
        .footerBotLeft .footerInfo {
            margin-left: -8px;
        }

        .footerBotLeft p {
            font-family: Arial, Helvetica, sans-serif, "宋体";
        }

        .footerBotLeft .footerInfo a {
            color: #666;
        }

        .footerBotLeft .copyright {
            color: #666;
        }
    </style>

    <script type="text/javascript" src="~/Wine/酒仙网-确认订单页面/订单结算-酒仙网_files/recommend_99.js"></script>
    <script type="text/javascript" src="~/Wine/酒仙网-确认订单页面/订单结算-酒仙网_files/p_code.js"></script>
    <script type="text/javascript" src="~/Wine/酒仙网-确认订单页面/订单结算-酒仙网_files/o_code.js"></script>


    <script src="~/Wine/酒仙网-确认订单页面/订单结算-酒仙网_files/region.js" type="text/javascript"></script>
</body>
</html>


<script>

    $(function () {
        //getarea();
        bindGoods();
      
    })
    function bindGoods() {

        $.ajax({
            url: 'http://localhost:50169/api/Address/GetAddressesList',
            type: "get",
            contentType: "application/json; charset=utf-8",
            async: false,
            crossDomain: true,
            dataType: 'json',
            success: function (data) {
                 
                $("#list").empty();
                if (data.length > 0) {
                    var html = "<table  class='table table-bordered' cellspacing='0' cellpadding='0' border='0'>";
                 
                    for (var i = 0; i < data.length; i++) {
                        html += "<tr  onclick=ret(" + data[i].id + ") >";
                        html += "<td  >" + data[i].addressPerson + "</td>";
                        html += "<td>" + data[i].detailAddress + "</td>";
                        html += "<td>" + data[i].addressPhone + "</td>";
                        html += "<td><input id='btnUpt' type='button' value='修改' onclick=upt(" + data[i].id + ") /><input id='btnDel' type='button' value='删除' onclick=del(this," + data[i].id + ") /></td>";
                        html += "</tr>";
                    }
                    html += "</table>";
                    $("#list").append(html);
                }

            }
        })

    }
    function ret(id) {
        $("#Hidden1").val(id);
        $.ajax({
            url: "http://localhost:50169/api/Address/GetAddressById?id=" + id,
            type: "get",
            dataType: "json",
            success: function (data) {
                console.log(data);
                $("#info").empty();

                    //var html = "<table  class='table table-bordered' cellspacing='0' cellpadding='0' border='0'>";
                    //    html += "<tr>";
                    //    html += "<td>寄送至:</td><td>" + data.detailAddress + "</td></br>";
                    //    html += "<td>收货人:</td><td>" + data.addressPerson + "</td><td>" + data.addressPhone + "</td>";
                    //    html += "</tr>";
                //html += "</table>";
                var html = "<span>";
                html += "<h2>寄送至:" + data.detailAddress + "</h2>";
                html += "<h2>收货人:" + data.addressPerson + "  " + data.addressPhone + "</h2>";
                html += "</br>"+"总金额:" + @ViewBag.sum;
                html += "</br>";
                html += "<h2><a href='/Shop/ShopIndex'>返回购物车</a><input id='Button1' type='button' value='提交订单' class='btn-danger' onclick='submit()'/></h2>";
                html += "</span>";
                    $("#info").append(html);


            }
        })
    }
    function submit() {
        var addressId= $("Hidden1").val();
        location.href = '/Shop/AddOrder?addressId' + addressId;
    }

    function del(obj, id) {
        if (confirm('确认要删除吗?')) {


            $.ajax({
                url: 'http://localhost:50169/api/Address/DelAddress?id=' + id,
                type: "delete",
                async: false,
                contentType: "application/json; charset=utf-8",
                async: false,
                crossDomain: true,
                dataType: 'json',
                success: function (data) {
                    if (data > 0) {
                        $(obj).parent().parent().remove();

                        alert('删除成功');
                    }

                }
            })
        }

    }

    //收货地址的修改
    function upt(id) {
        $.ajax({
            url: "http://localhost:50169/api/Address/GetAddressById?id=" + id,
            type: "get",
            dataType: "json",
            success: function (data) {
                console.log(data);
                var str2 = "";
                str2 = '<table>'
                    + '<tr>'
                    + '<td>收货人：</td>'
                    + '<td><input id="people" type="text" value="' + data.addressPerson + '"/></td>'
                    + '</tr>'
                    + '<tr>'
                    + '<td>地址：</td>'
                    + '<td><input id="address" type="text" value="' + data.detailAddress + '"/></td>'
                    + '</tr>'
                    + '<tr>'
                    + '<td>电话/手机号：</td>'
                    + '<td><input id="iphone" type="text" value="' + data.addressPhone + '"/></td>'
                    + '</tr>'
                    + '<tr>'
                    + '<td></td>'
                    + '<td><input id="Button1" type="button" class="btn btn-default" value="修改" onclick="UptAddress('+id+')" /></td>'
                    + '</tr>'
                    + '</table>';
                layer.open({
                    type: 0,
                    skin: "layui-layer-rim",
                    title: "收货地址修改",
                    maxmin: true,
                    content: str2,
                })
             
            }
        })
    }
    function UptAddress(id) {
        var id = id;
        var addressPerson = $("#people").val();
        var detailAddress = $("#address").val();
        var addressPhone = $("#iphone").val();



        var date = {
            "Id": id,
            "addressPerson": addressPerson,
            "detailAddress": detailAddress,
            "addressPhone": addressPhone

        };
        var val = JSON.stringify(date);
        $.ajax({
            url: 'http://localhost:50169/api/Address/UpdateAddress',
            data: val,
            type: "post",
            contentType: "application/json; charset=utf-8",
            async: false,
            crossDomain: true,
            dataType: 'json',
            success: function (data) {
                if (data > 0) {
                    alert("修改收货地址成功");
                    bindGoods();
                }
                else {
                    alert("修改收货地址失败");
                }
            }
        })
    }
    function getarea() {

        $.ajax({
            url: 'http://localhost:50169/api/Address/GetAreaList',
            data: { pid: 0 },
            type: "get",
            contentType: "application/json; charset=utf-8",
            async: false,
            crossDomain: true,
            dataType: 'json',
            success: function (data) {
                console.log(data)
                $("#province1").empty();
                var html = "";
                $("#province1").append('<option value="" >请选择</option>');

                $(data).each(function () {
                    html += ' <option value="' + this.id + '"  >' + this.areaName + '</option>';
                })
                $("#province1").append(html);

            }
        })
    }
    function city(pid) {
        pid = $("#province1").val();

        $.ajax({
            url: 'http://localhost:50169/api/Address/GetAreaList',
            data: { pid: pid },
            type: "get",
            contentType: "application/json; charset=utf-8",
            async: false,
            crossDomain: true,
            dataType: 'json',
            success: function (data) {
                $("#city").empty();
                var html = "";
                $("#city").append('<option value="" selected="selected">请选择</option>');

                $(data).each(function () {
                    html += ' <option value="' + this.id + '" >' + this.areaName + '</option>';
                })
                $("#city").append(html);

            }
        })
    }

    function district(pid) {
        pid = $("#city").val();

        $.ajax({
            url: 'http://localhost:50169/api/Address/GetAreaList',
            data: { pid: pid },
            type: "get",
            contentType: "application/json; charset=utf-8",
            async: false,
            crossDomain: true,
            dataType: 'json',
            success: function (data) {
                $("#district").empty();
                var html = "";
                $("#district").append('<option value="" selected="selected">请选择</option>');

                $(data).each(function () {
                    html += ' <option value="' + this.id + '" >' + this.areaName + '</option>';
                })
                $("#district").append(html);

            }
        })
    }
    //添加按鈕點擊事件，打開模態窗口
    function Address() {

        var str = "";
        str = '<table>'
            + '<tr>'
            + '<td>收货人：</td>'
            + '<td><input id="people" type="text" /></td>'
            + '</tr>'
            + '<tr>'
            + '<td>地区：</td>'
            + '<td><select name="province" id="province1" onchange="city()"><option value="" selected="selected">请选择</option></select ><select name="city" id="city" onchange="district()"> <option value="" selected="selected">请选择</option> </select> <select name="district" id="district"> <option value="" selected="selected">请选择</option> </select></td>'
            + '</tr>'
            + '<tr>'
            + '<td>详细地址：</td>'
            + '<td><input id="address" type="text"/></td>'
            + '</tr>'
            + '<tr>'
            + '<td>邮政编码：</td>'
            + '<td><input id="zipcode" type="text"/></td>'
            + '</tr>'
            + '<tr>'
            + '<td>手机：</td>'
            + '<td><input id="iphone" type="text"/></td>'
            + '</tr>'
            + '<tr>'
            + '<td></td>'
            + '<td><input id="Button1" type="button" class="btn btn-default" value="添加" onclick="InsertAddress()" /></td>'
            + '</tr>'
            + '</table>';
        layer.open({
            type: 0,
            skin: "layui-layer-rim",
            title: "收货地址添加",
            maxmin: true,
            content: str,
        })
        getarea();
    }
    //添加收货地址
    function InsertAddress() {
        var addressPerson = $("#people").val();
        var detailAddress = $("#address").val();
        var postalCode = $("#zipcode").val();
        var addressPhone = $("#iphone").val();
        var areaId = $("#province").val();
        if (addressPerson == "") {
            alert("收货人不能为空!");
            return false;
        }

        if (detailAddress == "") {
            alert("详细地址不能为空!");
            return false;
        }

        if (postalCode == "") {
            alert("邮政编码不能为空!");
            return false;
        }

        if (addressPhone == "") {
            alert("手机不能为空!");
            return false;
        }

        var date = {
            "id": 0,
            "addressPerson": addressPerson,
            "areaId": areaId,
            "usersId": 1,
            "detailAddress": detailAddress,
            "postalCode": postalCode,
            "addressPhone": addressPhone

        };
        var val = JSON.stringify(date);
        $.ajax({
            url: 'http://localhost:50169/api/Address/AddAddress',
            data: val,
            type: "post",
            contentType: "application/json; charset=utf-8",
            async: false,
            crossDomain: true,
            dataType: 'json',
            success: function (data) {
                if (data > 0) {
                    alert("添加收货地址成功");
                    bindGoods();
                }
                else {
                    alert("添加收货地址失败");
                }
            }
        })
    }
</script>