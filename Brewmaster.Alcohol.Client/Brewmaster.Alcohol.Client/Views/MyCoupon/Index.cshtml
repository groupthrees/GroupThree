
@{
    Layout = null;
}

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/jquery/dist/modernizr-2.8.3.js"></script>

    <script type="text/javascript" async="" charset="utf-8" src="~/Wine/我的酒仙网 ) 我的优惠券_files/pushData.txt"></script>
    <script type="text/javascript" async="" src="~/Wine/我的酒仙网 ) 我的优惠券_files/mv.js"></script>
    <script type="text/javascript" async="" src="~/Wine/我的酒仙网 ) 我的优惠券_files/mba.js"></script>
    <script type="text/javascript" async="" src="~/Wine/我的酒仙网 ) 我的优惠券_files/visittrack.js"></script>
    <script type="text/javascript" async="" src="~/Wine/我的酒仙网 ) 我的优惠券_files/mvl.js"></script>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="pragma" content="no-cache" />
    <meta name="save" content="history" />
    <meta http-equiv="Expires" content="0" />
    <meta http-equiv="Cache-Control" content="no-cache,must-revalidate" />
    <script type="text/javascript">
        var mobileRegex_o = "^1[3-9][0-9]{9}$";// 对象 new RegExp
        var mobileRegex_s = /^1[3-9][0-9]{9}$/;// 字符串
        var mobileRegex_s_star = /^1[3-9][0-9]{9}$|^([0-9]{3}\*{4}[0-9]{4})$/;
        var mobileRegex_o_star = "^1[3-9][0-9]{9}$|^([0-9]{3}\\*{4}[0-9]{4})$";
    </script>
    <script src="~/Wine/我的酒仙网 ) 我的优惠券_files/usercenter-web-pc.js" type="text/javascript"></script>
    <title>我的酒仙网 &gt; 我的优惠券 </title>
    <link href="~/Wine/我的酒仙网 ) 我的优惠券_files/base.css" type="text/css" rel="stylesheet" />
    <link href="~/Wine/我的酒仙网 ) 我的优惠券_files/header.css" rel="stylesheet" type="text/css" />
    <link href="~/Wine/我的酒仙网 ) 我的优惠券_files/footer.css" rel="stylesheet" type="text/css" />

    <link href="~/Wine/我的酒仙网 ) 我的优惠券_files/user.css" rel="stylesheet" type="text/css" />
    <link href="~/Wine/我的酒仙网 ) 我的优惠券_files/user_nav.css" rel="stylesheet" type="text/css" />

    <script src="~/Wine/我的酒仙网 ) 我的优惠券_files/jquery_002.js" type="text/javascript"></script>
    <script src="~/Wine/我的酒仙网 ) 我的优惠券_files/jquery.js" type="text/javascript"></script>
    <script src="~/Wine/我的酒仙网 ) 我的优惠券_files/base.js" type="text/javascript"></script>
    <script src="~/Wine/我的酒仙网 ) 我的优惠券_files/region.js" type="text/javascript"></script>
    <script src="~/Wine/我的酒仙网 ) 我的优惠券_files/public.js" type="text/javascript"></script>

    <script src="~/Wine/我的酒仙网 ) 我的优惠券_files/userCenterCtrlWidth.js" type="text/javascript"></script>
    <script src="~/Wine/我的酒仙网 ) 我的优惠券_files/Slider.js" type="text/javascript"></script>
    <script src="~/Wine/我的酒仙网 ) 我的优惠券_files/position.js" type="text/javascript"></script>
    <script src="~/Wine/我的酒仙网 ) 我的优惠券_files/turn_bottom.js" type="text/javascript"></script>
    <script src="~/Wine/我的酒仙网 ) 我的优惠券_files/easing.js" type="text/javascript"></script>
    <script src="~/Wine/我的酒仙网 ) 我的优惠券_files/usercenter.js" type="text/javascript"></script>
    <script src="~/Wine/我的酒仙网 ) 我的优惠券_files/sidenav.js" type="text/javascript"></script>
    <script src="~/Wine/我的酒仙网 ) 我的优惠券_files/alert.js" type="text/javascript"></script>

    <link type="text/css" rel="stylesheet" href="~/Wine/我的酒仙网 ) 我的优惠券_files/userCenter.css" />
    <script type="text/javascript" src="~/Wine/我的酒仙网 ) 我的优惠券_files/bonus.js"></script>

    <link href="~/Wine/我的酒仙网 ) 我的优惠券_files/user_1200.css" id="newLink" rel="stylesheet" type="text/css" />
    <!-- <script src="http://misc.jiuxian.com/js/usercenter/Verification.js" type="text/javascript"></script> -->

</head>
<body>



    <script src="~/Wine/我的酒仙网 ) 我的优惠券_files/skipmobileweb.js"></script>
    <script type="text/javascript">isMobile();</script>
    <div>
        <div class="rightTit"><h2><i></i>我的优惠券</h2></div>
        <div class="rightCon">
           
            <div class="myRedBox">
                <div class="myRedTit clearfix">
                    <ul>
                        <li id="unused" class="reduce wrapinner" onclick="javascript:document.getElementById('11').click();">未使用</li>
                        <li id="used" class="reduce" onclick="javascript:document.getElementById('12').click();">已使用</li>
                        <li id="offeffect" class="reduce" onclick="javascript:document.getElementById('13').click();">已过期</li>
                    </ul>
                    <a id="11" href="http://member.jiuxian.com/purse/my_coupon-11.htm" display:none=""></a>
                    <a id="12" href="http://member.jiuxian.com/purse/my_coupon-12.htm" display:none=""></a>
                    <a id="13" href="http://member.jiuxian.com/purse/my_coupon-13.htm" display:none=""></a>
                    <span class="Instruction clearfix"><a href="http://help.jiuxian.com/view-2-114.htm" target="_blank">优惠券使用说明</a><i></i></span>
                </div>

                <div class="rightCon-content">

                    <table style=" border:1px solid #e4e4e4; border-top:none; width:100%;" cellspacing="0" cellpadding="0" border="0">
                        <thead>
                            <tr class="rightCon-trth">
                                <th class="li1">名称</th>
                                <th class="li2">优惠金额</th>
                                <th class="li3">满足金额</th>
                                <th class="li4">截止时间</th>
                            </tr>
                        </thead>
                        <tbody id="await"></tbody>
                    </table>
                    <a href="javascript:void(0)" onclick="first()">首页</a>
                    <a href="javascript:void(0)" onclick="prve()">上一页</a>
                    <a href="javascript:void(0)" onclick="next()">下一页</a>
                    <a href="javascript:void(0)" onclick="last()">尾页</a>
                </div>



            </div>
        </div>

    </div>

    <!-- 右侧 -->
    <style type="text/css">
        .footerBotLeft .footerInfo {
            margin-left: -8px;
        }

        .footerBotLeft p {
            font-family: Arial, Helvetica, sans-serif, "宋体";
        }

        .footerBotLeft .footerInfo a {
            color: #666;
        }

        .footerBotLeft .copyright {
            color: #666;
        }
    </style>


</body>
</html>

<script>

    var pageIndex = 1;
    var pageSize = 3;
    var total = 0;

    $(function () {
        getCoupon(pageIndex);
    })

    function getCoupon(index) {
        $.ajax({
            type: "get",
            url: 'http://localhost:50169/api/Coupon/Getcouponlist',
            data: { id: 1, pageIndex: index, pageSize: pageSize },
            success: function (result) {
                var tmphtml = "";
                $("#await").empty();
                for (var i = 0; i < result.couponList.length; i++) {
                    var endTime = dateFormat(result.couponList[i].couponEndTime);
                    tmphtml += "<tr>";
                    tmphtml += "<td>" + result.couponList[i].couponName + "</td>";
                    tmphtml += "<td>" + result.couponList[i].couponMoney + "</td>";
                    tmphtml += "<td>" + result.couponList[i].couponCondition + "</td>";
                    tmphtml += "<td>" + endTime+ "</td>";
                    tmphtml += "</tr>";
                }
                $("#await").append(tmphtml);
                total = result.total;
            }
        })
    }

    /**************************************时间格式化处理************************************/
    function dateFormat(tmpDate) { //author: meizz   

        var fmt = "yyyy-MM-dd hh:mm:ss";
        var date = new Date(tmpDate)
        var o = {
            "M+": date.getMonth() + 1,                 //月份   
            "d+": date.getDate(),                    //日   
            "h+": date.getHours(),                   //小时   
            "m+": date.getMinutes(),                 //分   
            "s+": date.getSeconds(),                 //秒   
            "q+": Math.floor((date.getMonth() + 3) / 3), //季度   
            "S": date.getMilliseconds()             //毫秒   
        };
        if (/(y+)/.test(fmt))
            fmt = fmt.replace(RegExp.$1, (date.getFullYear() + "").substr(4 - RegExp.$1.length));
        for (var k in o)
            if (new RegExp("(" + k + ")").test(fmt))
                fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : (("00" + o[k]).substr(("" + o[k]).length)));
        return fmt;
    }

    //查询
    function search() {
        getCoupon(pageIndex);
    }

    //首页
    function first() {
        pageIndex = 1;

        getCoupon(pageIndex);
    }

    //上页
    function prve() {
        pageIndex = pageIndex > 1 ? pageIndex - 1 : 1;
        getCoupon(pageIndex);
    }

    //下页
    function next() {
        var nums = Math.ceil(total / pageSize);
        pageIndex = pageIndex < nums ? pageIndex + 1 : pageIndex;
        getCoupon(pageIndex);
    }

    //尾页
    function last() {
        pageIndex = Math.ceil(total / pageSize);
        getCoupon(pageIndex);
    }

</script>


 